<mat-toolbar>
    <button class="custom-btn icon" (click)="back()">
        <mat-icon class="icon-align">arrow_back</mat-icon>
    </button>
    &nbsp;
    <button *ngIf="isvendor" class="custom-btn icon" (click)="downloadInvoice()">
        <mat-icon class="icon-align">save_alt</mat-icon>
    </button>

    <button *ngIf="!isvendor" class="custom-btn icon" (click)="pStaffDownloadInvoice()">
        <mat-icon class="icon-align">save_alt</mat-icon>
    </button>

    <span class="example-spacer"></span> {{'purchase.invoice.title' | translate | titlecase}} <span
        class="example-spacer"></span>
</mat-toolbar>

<mat-toolbar class="error-message" *ngIf="hasError">
    <!-- Invoice already hase issued -->
    <app-error></app-error>
</mat-toolbar>

<div class="container-fluid" *ngIf="invoiceList">
    <div class="row my-3">
        <div class="col-9">
            <strong>
                <p class="text-muted font-italic">
                    {{'purchase.delivery-order.labels.supplier' | translate | titlecase}}
                </p>
            </strong>

            <div class="p-3 mt-4 table-bordered">

                <span>{{invoiceList.vendor.company_name}}</span> <br>
                <span>{{invoiceList.vendor.biz_reg_num}}</span> <br>
                <span
                    *ngIf="invoiceList.vendor.vendor_address.addr_line_1 != ''">{{invoiceList.vendor.vendor_address.addr_line_1}}</span><br>
                <span
                    *ngIf="invoiceList.vendor.vendor_address.addr_line_2 != ''">{{invoiceList.vendor.vendor_address.addr_line_2}}<br></span>
                <span
                    *ngIf="invoiceList.vendor.vendor_address.addr_line_3 != ''">{{invoiceList.vendor.vendor_address.addr_line_3}}<br></span>
                <span>{{invoiceList.vendor.vendor_address.postcode}},</span>
                <span>{{invoiceList.vendor.vendor_address.city}},</span>
                <span>{{invoiceList.vendor.vendor_address.state.name}},</span> <br>
                <span>{{'purchase.delivery-order.labels.tel' | translate}} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:
                    {{invoiceList.vendor.office_phone}}</span> <br>
                <span>{{'purchase.delivery-order.labels.sst_no' | translate}}: {{invoiceList.vendor.tax_num}}</span>
            </div>

        </div>
        <div class="col-3">
            <div class="">
                <h3>{{'purchase.invoice.title' | translate | titlecase}}</h3>
                <label> {{'purchase.invoice.labels.invoice-ref' | translate | titlecase}} : </label>
                <span>{{invoiceList.invoice_ref}}</span> <br>
                <label> {{'purchase.invoice.labels.invoice-date' | translate | titlecase}}: </label>
                <span>{{invoiceList.issued_date | date: 'mediumDate'}}</span><br>
                <label> {{'purchase.invoice.labels.due-date' | translate | titlecase}} : </label>
                <span>{{invoiceList.due_date | date : 'mediumDate'}}</span>
            </div>
        </div>
    </div>

    <strong>
        <p class="text-muted font-italic">
            {{'purchase.delivery-order.labels.deliver-to' | translate | titlecase}}
        </p>
    </strong>

    <div class="p-3 table-bordered">
        <span>{{invoiceList.issued_by.company.name | titlecase}}</span> <br>
        <span>{{invoiceList.issued_by.company.biz_reg_num}}</span> <br>
        <span
            *ngIf="invoiceList.issued_by.company.address.addr_line_1 != ''">{{invoiceList.issued_by.company.address.addr_line_1}}</span><br>
        <span
            *ngIf="invoiceList.issued_by.company.address.addr_line_2 != ''">{{invoiceList.issued_by.company.address.addr_line_2}}<br></span>
        <span
            *ngIf="invoiceList.issued_by.company.address.addr_line_3 != ''">{{invoiceList.issued_by.company.address.addr_line_3}}<br></span>
        <span>{{invoiceList.issued_by.company.address.postcode}},</span>
        <span>{{invoiceList.issued_by.company.address.city}},</span>
        <span>{{invoiceList.issued_by.company.address.state.name}},</span> <br>

    </div>

    <br>
    <table class="table table-bordered" style="border:none!important; text-align: center">
        <tr>
            <th> {{'purchase.invoice.labels.bill-to.lbs.item' | translate | titlecase}}</th>
            <th> {{'purchase.invoice.labels.bill-to.lbs.quantity' | translate | titlecase}} </th>
            <th> SST </th>
            <th> {{'purchase.invoice.labels.bill-to.lbs.price' | translate | titlecase}}</th>
        </tr>

        <tr *ngFor="let do of invoiceList.invoice_products let i = index">
            <td>{{do.material.name | titlecase}}</td>
            <td>{{do.quantity}}</td>
            <td>{{do.tax | currency:'RM'}}</td>
            <td>{{do.price | currency:'RM '}}</td>
        </tr>
        <tr style="border:none!important">
            <td style="border:none!important" colspan="3"></td>
            <td>
                <div class="row">
                    <div class="col-xl-5 col-md-6 px-2 pt-2" style="text-align: right">Total Tax: RM</div>
                    <div class="col-2 px-2 pt-2" style="text-align: right">{{ invoiceList.total_tax }}</div>
                </div>

                <div class="row">
                        <div class="col-xl-5 col-md-6 px-2 pt-2" style="text-align: right">{{'purchase.invoice.labels.bill-to.lbs.subtotal' | translate | titlecase}}: RM</div>
                        <div class="col-2 px-2 pt-2" style="text-align: right">{{invoiceList.total}}</div>
                    </div>

                <div class="row">
                    <div class="col-xl-5 col-md-6 px-2 pt-2" style="text-align: right">Total: RM</div>
                    <div class="col-2 px-2 pt-2" style="text-align: right">{{ invoiceList.grand_total }}</div>
                </div>
                <div class="row">
                    <div class="col-xl-5 col-md-6 px-2 pt-2" style="text-align: right">Rounding Adj: RM</div>
                    <div class="col-2 px-2 pt-2" style="text-align: right">{{ invoiceList.adj }}</div>
                </div>
            </td>
        </tr>
    </table>

    <mat-toolbar-row *ngIf="isvendor">
        <span class="example-spacer"></span>
        <button [disabled]="invoiceList.status == 1" (click)="issueInvoice()" mat-raised-button
            color="primary">{{'purchase.invoice.btns.issue-invoice' | translate | titlecase}} </button>
        <span class="example-spacer"></span>
    </mat-toolbar-row>
</div>